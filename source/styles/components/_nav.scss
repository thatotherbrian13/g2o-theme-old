/**
 * Navigation Component
 * 
 * Award-level, accessible navigation with polished interactions
 * Uses G2O brand tokens and follows BEM methodology
 */

/* =============================================================================
   CSS Custom Properties (Brand Tokens)
   ========================================================================== */

:root {
  /* G2O Brand Colors */
  --g2o-color-primary: #234253;    /* Deep teal/navy */
  --g2o-color-accent: #72d1f6;     /* Light blue/cyan */
  --g2o-color-highlight: #ff4f55;  /* Coral red */
  --g2o-color-light: #f7f7f7;      /* Light gray */
  --g2o-color-limestone: #fff7ef;  /* Off-white */
  --g2o-color-pure-white: #ffffff; /* Pure white */
  
  /* Navigation-specific tokens */
  --nav-bg: rgba(255, 247, 239, 0.95);
  --nav-bg-mobile: var(--g2o-color-primary);
  --nav-text: var(--g2o-color-primary);
  --nav-text-mobile: var(--g2o-color-limestone);
  --nav-text-hover: var(--g2o-color-accent);
  --nav-border: rgba(35, 67, 83, 0.1);
  --nav-shadow: rgba(35, 67, 83, 0.08);
  --nav-backdrop: rgba(35, 67, 83, 0.6);
  
  /* Timing and easing */
  --nav-transition-fast: 120ms ease-out;
  --nav-transition-normal: 180ms ease-out;
  --nav-transition-slow: 280ms ease-out;
  
  /* Spacing scale */
  --nav-space-xs: 0.25rem;   /* 4px */
  --nav-space-sm: 0.5rem;    /* 8px */
  --nav-space-md: 0.75rem;   /* 12px */
  --nav-space-lg: 1rem;      /* 16px */
  --nav-space-xl: 1.5rem;    /* 24px */
  --nav-space-xxl: 2rem;     /* 32px */
  
  /* Typography */
  --nav-font-size: 1rem;
  --nav-font-weight: 400;
  --nav-font-weight-bold: 600;
  --nav-line-height: 1.5;
  
  /* Z-index scale */
  --nav-z-dropdown: 1000;
  --nav-z-mobile: 9999;
  --nav-z-backdrop: 9998;
}

/* Dark theme overrides */
.page-theme-dark {
  --nav-bg: rgba(35, 67, 83, 0.95);
  --nav-text: var(--g2o-color-limestone);
  --nav-text-hover: var(--g2o-color-accent);
  --nav-border: rgba(255, 247, 239, 0.1);
  --nav-shadow: rgba(0, 0, 0, 0.2);
}

/* Reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  :root {
    --nav-transition-fast: 0ms;
    --nav-transition-normal: 0ms;
    --nav-transition-slow: 0ms;
  }
}

/* =============================================================================
   Header Component
   ========================================================================== */

.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: var(--nav-z-dropdown);
  transition: transform var(--nav-transition-normal);
}

.header__backdrop {
  position: absolute;
  inset: 0;
  background: var(--nav-bg);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid var(--nav-border);
  opacity: 0;
  transition: opacity var(--nav-transition-normal);
}

.header[data-scrolled] .header__backdrop {
  opacity: 1;
}

.header__container {
  position: relative;
  z-index: 2;
  padding: var(--nav-space-lg) 0;
  transition: padding var(--nav-transition-normal);
}

.header[data-scrolled] .header__container {
  padding: var(--nav-space-md) 0;
}

.header__inner {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 var(--nav-space-xl);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--nav-space-xl);
}

.header__brand {
  flex-shrink: 0;
}

.header__logo {
  display: block;
  color: var(--nav-text);
  transition: color var(--nav-transition-fast);
  
  &:hover {
    color: var(--nav-text-hover);
  }
  
  &:focus-visible {
    outline: 2px solid var(--g2o-color-accent);
    outline-offset: 2px;
    border-radius: 4px;
  }
}

.header__logo-svg {
  width: 84px;
  height: 32px;
  display: block;
}

.header__navigation {
  flex: 1;
}

.header__actions {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: var(--nav-space-lg);
}

/* Intersection Observer sentinel for sticky behavior */
.header__sentinel {
  position: absolute;
  top: -1px;
  height: 1px;
  width: 1px;
  opacity: 0;
  pointer-events: none;
}

/* =============================================================================
   Navigation Component
   ========================================================================== */

.nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

/* Desktop Navigation */
.nav__desktop {
  display: none;
  
  @media (min-width: 1024px) {
    display: block;
  }
}

.nav__menu {
  display: flex;
  list-style: none;
  margin: 0;
  padding: 0;
  gap: var(--nav-space-lg);
}

.nav__item {
  position: relative;
  
  &:focus-within .nav__dropdown {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }
}

.nav__link {
  display: flex;
  align-items: center;
  gap: var(--nav-space-xs);
  padding: var(--nav-space-sm) var(--nav-space-md);
  color: var(--nav-text);
  text-decoration: none;
  font-size: var(--nav-font-size);
  font-weight: var(--nav-font-weight);
  line-height: var(--nav-line-height);
  border-radius: 6px;
  background: transparent;
  border: none;
  cursor: pointer;
  transition: 
    color var(--nav-transition-fast),
    background-color var(--nav-transition-fast);
  
  &:hover {
    color: var(--nav-text-hover);
    background-color: rgba(114, 209, 246, 0.1);
  }
  
  &:focus-visible {
    outline: 2px solid var(--g2o-color-accent);
    outline-offset: 2px;
  }
}

.nav__item--current .nav__link {
  color: var(--nav-text-hover);
  font-weight: var(--nav-font-weight-bold);
}

.nav__text {
  /* Text wrapper for easier styling */
}

.nav__icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 12px;
  height: 8px;
  transition: transform var(--nav-transition-fast);
  
  svg {
    width: 100%;
    height: 100%;
  }
}

.nav__link[aria-expanded="true"] .nav__icon {
  transform: rotate(180deg);
}

/* Dropdown Styles */
.nav__dropdown {
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(8px);
  min-width: 240px;
  background: var(--g2o-color-pure-white);
  border: 1px solid var(--nav-border);
  border-radius: 8px;
  box-shadow: 
    0 4px 6px -1px var(--nav-shadow),
    0 2px 4px -1px var(--nav-shadow);
  opacity: 0;
  visibility: hidden;
  transition: 
    opacity var(--nav-transition-normal),
    visibility var(--nav-transition-normal),
    transform var(--nav-transition-normal);
  z-index: var(--nav-z-dropdown);
  
  /* Smart viewport clamping */
  @media (max-width: 640px) {
    left: 0;
    transform: translateY(8px);
    width: calc(100vw - 2rem);
    margin: 0 1rem;
  }
}

.nav__dropdown[aria-hidden="false"] {
  opacity: 1;
  visibility: visible;
  transform: translateX(-50%) translateY(0);
  
  @media (max-width: 640px) {
    transform: translateY(0);
  }
}

.nav__submenu {
  list-style: none;
  margin: 0;
  padding: var(--nav-space-sm);
  
  .nav__link {
    display: block;
    padding: var(--nav-space-md);
    color: var(--g2o-color-primary);
    border-radius: 4px;
    
    &:hover {
      background-color: var(--g2o-color-light);
      color: var(--g2o-color-primary);
    }
  }
}

/* Mobile Navigation */
.nav__toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  background: transparent;
  border: none;
  color: var(--nav-text);
  cursor: pointer;
  border-radius: 6px;
  transition: 
    background-color var(--nav-transition-fast),
    color var(--nav-transition-fast);
  
  &:hover {
    background-color: rgba(114, 209, 246, 0.1);
    color: var(--nav-text-hover);
  }
  
  &:focus-visible {
    outline: 2px solid var(--g2o-color-accent);
    outline-offset: 2px;
  }
  
  @media (min-width: 1024px) {
    display: none;
  }
}

.nav__toggle-icon {
  display: flex;
  flex-direction: column;
  gap: 4px;
  width: 20px;
  height: 16px;
}

.nav__toggle-line {
  width: 100%;
  height: 2px;
  background: currentColor;
  border-radius: 1px;
  transition: 
    transform var(--nav-transition-normal),
    opacity var(--nav-transition-normal);
}

/* Hamburger to X animation */
.nav__toggle[aria-expanded="true"] .nav__toggle-line {
  &:nth-child(1) {
    transform: translateY(6px) rotate(45deg);
  }
  
  &:nth-child(2) {
    opacity: 0;
  }
  
  &:nth-child(3) {
    transform: translateY(-6px) rotate(-45deg);
  }
}

/* Mobile Panel */
.nav__mobile {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  max-width: 400px;
  background: var(--nav-bg-mobile);
  transform: translateX(100%);
  transition: transform var(--nav-transition-slow);
  z-index: var(--nav-z-mobile);
  display: flex;
  flex-direction: column;
  
  @media (min-width: 1024px) {
    display: none;
  }
}

.nav__mobile[aria-hidden="false"] {
  transform: translateX(0);
}

.nav__mobile-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--nav-space-xl);
  border-bottom: 1px solid rgba(255, 247, 239, 0.1);
}

.nav__mobile-title {
  color: var(--nav-text-mobile);
  font-size: 1.25rem;
  font-weight: var(--nav-font-weight-bold);
  margin: 0;
}

.nav__mobile-close {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 44px;
  height: 44px;
  background: transparent;
  border: none;
  color: var(--nav-text-mobile);
  cursor: pointer;
  border-radius: 6px;
  transition: 
    background-color var(--nav-transition-fast),
    color var(--nav-transition-fast);
  
  &:hover {
    background-color: rgba(114, 209, 246, 0.1);
  }
  
  &:focus-visible {
    outline: 2px solid var(--g2o-color-accent);
    outline-offset: 2px;
  }
}

.nav__mobile-content {
  flex: 1;
  overflow-y: auto;
  padding: var(--nav-space-xl);
  
  .nav__mobile-menu {
    list-style: none;
    margin: 0;
    padding: 0;
    
    .nav__item {
      border-bottom: 1px solid rgba(255, 247, 239, 0.1);
      
      &:last-child {
        border-bottom: none;
      }
    }
    
    .nav__link {
      display: block;
      padding: var(--nav-space-lg) 0;
      color: var(--nav-text-mobile);
      font-size: 1.125rem;
      
      &:hover {
        color: var(--g2o-color-accent);
        background: transparent;
      }
    }
  }
}

.nav__mobile-utility {
  margin-top: var(--nav-space-xxl);
  padding-top: var(--nav-space-xl);
  border-top: 1px solid rgba(255, 247, 239, 0.1);
  
  .nav__utility-menu {
    list-style: none;
    margin: 0;
    padding: 0;
    
    .nav__link {
      display: block;
      padding: var(--nav-space-md) 0;
      color: var(--g2o-color-accent);
      font-size: var(--nav-font-size);
      
      &:hover {
        color: var(--g2o-color-limestone);
      }
    }
  }
}

/* Mobile Backdrop */
.nav__backdrop {
  position: fixed;
  inset: 0;
  background: var(--nav-backdrop);
  opacity: 0;
  visibility: hidden;
  transition: 
    opacity var(--nav-transition-slow),
    visibility var(--nav-transition-slow);
  z-index: calc(var(--nav-z-mobile) - 1);
  
  @media (min-width: 1024px) {
    display: none;
  }
}

.nav__backdrop[aria-hidden="false"] {
  opacity: 1;
  visibility: visible;
}

/* Utility Menu (Desktop) */
.nav__utility {
  display: none;
  
  @media (min-width: 1024px) {
    display: block;
  }
  
  .nav__utility-menu {
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
    gap: var(--nav-space-md);
    
    .nav__link {
      padding: var(--nav-space-sm);
      font-size: 0.875rem;
      color: var(--g2o-color-accent);
      
      &:hover {
        color: var(--nav-text);
        background-color: rgba(114, 209, 246, 0.1);
      }
    }
  }
}

/* =============================================================================
   Screen Reader Support
   ========================================================================== */

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* =============================================================================
   Focus Management (when mobile nav is open)
   ========================================================================== */

body[data-nav-open] {
  overflow: hidden;
  
  /* Make main content inert when mobile nav is open */
  & > *:not(.header):not(.nav) {
    pointer-events: none;
    user-select: none;
  }
}

/* =============================================================================
   Print Styles
   ========================================================================== */

@media print {
  .nav__mobile,
  .nav__backdrop,
  .nav__toggle {
    display: none !important;
  }
  
  .header {
    position: static;
  }
  
  .nav__dropdown {
    position: static;
    opacity: 1 !important;
    visibility: visible !important;
    transform: none !important;
    box-shadow: none;
    border: 1px solid #ccc;
  }
}